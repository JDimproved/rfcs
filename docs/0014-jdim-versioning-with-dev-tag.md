<!--
このファイルはRFC文書のテンプレートです。
新しい文書を作成する際にコピーしてお使いください。
ファイルは MIT or Apache-2.0 のデュアルライセンスで取り込まれます。

# ファイルの構成
RFC文書のファイル形式はMarkdownを使用します。
文書の構成はテンプレートに従わなくても良いです。
不要な項目の省略などフォーマットの変更は自由に行ってください。

# ファイルの編集
アンダースコアで囲われた部分は文書作成者が趣旨にあった内容に置き換えてください。
このコメントは削除して構いません。
-->

# dev タグ導入による開発バージョン管理
_ファイル冒頭にタイトルを書きます。タイトルにRFC番号を含める必要はありません。_

- [Abstract](#Abstract)
- [Specification](#Specification)
- [Examples](#Examples)
- [Motivation](#Motivation)
- [Rationale](#Rationale)
- [Backwards Compatibility](#Backwards-Compatibility)
- [Rejected Ideas](#Rejected-Ideas)
- [Open Issues](#Issues)


<a name="Abstract"></a>
## Abstract
_文書の内容をまとめた概要を書きます。_

JDim のバージョンフォーマットを変更し、開発中であることを表す dev タグを導入します。

> [!NOTE]  
> dev タグはGitタグとして作成するものではなく、
> `jdim --version`で表示するバージョン情報に含まれる開発段階を表すタグ(リリース修飾子)です。

<a name="Specification"></a>
## Specification
_機能の追加や変更を提案するときは仕様を書きます。_

リリース後、最初の更新作業開始時に master ブランチのバージョンに dev タグを追加します。

- 開発中バージョンのフォーマットは `<次期リリースの番号>-dev<日付>` とします。
- 機能フリーズの期間に入ったとき beta タグに更新します。

**dev タグを用いたバージョンの例**:  

- 0.13.0-dev20240820


<a name="Examples"></a>
## Examples
_ユーザーが提案された機能をどのように使うのか例を書きます。_

**バージョン表記例**:  

状況 | 現行バージョン表記 | 更新案バージョン表記 |
--- | --- | --- |
0.12.0 リリース | 0.12.0-20240706 | 0.12.0-20240706 |
0.13.0 開発中   | 0.12.0-20240820 | 0.13.0-dev20240820 :new: |
0.13.0 機能フリーズ | 0.13.0-beta20241225 | 0.13.0-beta20241225 |
0.13.0 リリース | 0.13.0-20250110 | 0.13.0-20250110 |

※バージョンは例です。実際のバージョンとは異なります。


<a name="Motivation"></a>
## Motivation
_提案が必要になった背景や動機を書きます。_

JDim のバージョンは番号、開発段階タグ、日付の3つで構成されています。

区分 | 説明
---  | ---
番号 | ドット(.)で区切られた3つの数値(メジャー . マイナー . マイクロ)
開発段階タグ | 開発段階を表す省略可能な文字列です。機能フリーズからリリースまで beta を使用します。
日付 | ソースコードが修正された日時、形式は `YYYYMMDD`, 例えば2024年7月10日なら `20240710` となります。

- 番号の各桁は独立した数値として扱われるため、9 の次は 10 となります。
- バージョンのフォーマットは `<番号>-<開発段階タグ><日付>` となります。

**例**:  

- 0.12.0-20240820
- 0.13.0-beta20241225

#### 現状の問題点

リリース後に修正が加えられてもバージョン番号が変わらなければ、一見して最新版かそうでないか判別できません。
このため、ユーザーがリリース版と開発版のどちらを使っているか判断しづらく、issue や掲示板での対応が難しくなっています。


<a name="Rationale"></a>
## Rationale
_Specificationに書かれた解決策を選んだ理由を書きます。_

開発中のバージョンを表すために "dev" を使用しているソフトウェアの例として、Android 用2ch互換掲示板アプリの ChMate があります。
"dev" は、ユーザーにとって他の案より馴染みのある表記である可能性が高いです。

リリース後すぐに dev タグを付与しない理由は、以下のようにいくつかあります。

- リリース直後はsnapパッケージのビルドが完了していないため。
- リリース後にGitリポジトリからソースを更新するユーザーに配慮するため。

**参考資料**  

- プログラミング言語Pythonのパッケージ仕様にまとめられている[バージョンの付け方][py]

[py]: https://packaging.python.org/en/latest/specifications/version-specifiers/

<a name="Backwards-Compatibility"></a>
## Backwards Compatibility
_後方互換性への影響を書きます。_

dev タグは新しいバージョンのみに追加されます。

ビルドスクリプトなどで beta タグによって処理を分岐させている場合、
dev タグの存在も考慮するように条件分岐を追加する必要があるかもしれません。


<a name="Rejected-Ideas"></a>
## Rejected Ideas
_採用しなかった他のアイデアと却下の理由を書きます。_

#### 却下したタグの案とその理由

- **alpha**  
  理由: 多くのソフトウェアで開発版リリースに使用されていますが、
  alpha版は次のバージョンに入る主要な機能が追加された段階を指すことが多く、
  リリース直後の早期開発段階には合わないため候補から外しました。

- **nightly**  
  理由: 毎日更新される開発バージョンに使用されますが、
  JDim は CI/CD でsnapパッケージを毎日更新しているわけではないため候補から外しました。

- **weekly** や **monthly**  
  理由: 毎週/毎月更新される開発バージョンに使用されますが、定期的リリースを行わない場合は適切ではないため候補から外しました。

- **canary**  
  理由: Webブラウザ Google Chrome やその派生物で使用されていますが、
  JDim は Chrome と技術的に無関係であるため、誤解を避けるために候補から外しました。

- **通常の開発では到達不可能な、次のリリースバージョンに近い値にする (例: 開発中: 0.12.99 → リリース: 0.13.0)**  
  理由: 一部のソフトウェアでは、大きなバージョンアップを予告するために使用されますが、
  開発に関わっていないと意味やニュアンスが伝わりにくい可能性があるため、候補から外しました。

 
<a name="Issues"></a>
## Open Issues
_未解決の問題を書きます。_

- **現行リリースのバグ修正版をリリースする必要が生じた際はどうするか**  
  バグ修正版が必要になった場合は、改めてissueを作成し話し合います。
